## Graphing the output of various tests in the RandomPlotGenerator Library
##



## User defined

wkt <- "POLYGON ((513820.1 7017121, 513833.4 7017112, 513843.6 7017102, 513843.6 7017060, 513841.9 7017065, 513837.8 7017077, 513828 7017101, 513822.9 7017113, 513820.1 7017121))"
repeats <- 100




## Attach packages

library(sf)
library(magrittr)





## Simple

polyOut <- "POLYGON ((513820.1 7017121, 513833.4 7017112, 513843.6 7017102, 513843.6 7017060, 513841.9 7017065, 513837.8 7017077, 513828 7017101, 513822.9 7017113, 513820.1 7017121))"
poly <- st_as_sfc(polyOut)

triOut <- "MULTIPOLYGON (((513837.8 7017077, 513843.6 7017102, 513828 7017101, 513837.8 7017077)), ((513841.9 7017065, 513843.6 7017060, 513843.6 7017102, 513841.9 7017065)), ((513820.1 7017121, 513822.9 7017113, 513833.4 7017112, 513820.1 7017121)), ((513837.8 7017077, 513841.9 7017065, 513843.6 7017102, 513837.8 7017077)), ((513828 7017101, 513833.4 7017112, 513822.9 7017113, 513828 7017101)), ((513833.4 7017112, 513828 7017101, 513843.6 7017102, 513833.4 7017112)))"
triangles <- st_as_sfc(triOut)

areaOut <- c(192.1, 35.7, 40.6, 86.05, 60.45, 83.1)

plot(poly)
plot(triangles, add = TRUE)


st_area(st_cast(triangles, "POLYGON"))
areaOut





## Weighted

probOut <- c(0.962, 0.4301, 0.4892, 0.9988, 0.7283, 1)
prob <- st_cast(triangles, "POLYGON") %>% 
  st_area %>% 
  as.numeric %>% 
  divide_by(sum(.)) %>% 
  round(4)

prob
probOut

"Test_Weighted:
i: 0  Alias: 3  Weight: 0.962
i: 1  Alias: 0  Weight: 0.4301
i: 2  Alias: 0  Weight: 0.4892
i: 3  Alias: 5  Weight: 0.9988
i: 4  Alias: 0  Weight: 0.7283
i: 5  Alias: 5  Weight: 1"

"Answer: 
i: 0  Alias: 3  Weight: 0.962
i: 1  Alias: 0  Weight: 0.4301
i: 2  Alias: 0  Weight: 0.4892
i: 3  Alias: 5  Weight: 0.9988
i: 4  Alias: 0  Weight: 0.7283
i: 5  Alias: 5  Weight: 1"


sampleOut <- "MULTIPOINT((513824.2023743715 7017117.941234225), (513831.61347526446 7017101.346400039), (513837.5636887081 7017092.653505156), (513839.9759868893 7017093.138833646), (513834.2344750516 7017104.5276810285), (513840.0328850783 7017098.936405899), (513842.19026397605 7017080.7970085135), (513837.80886579637 7017094.68441566), (513840.0307742336 7017092.941917359), (513842.9495727192 7017080.237572514))"
sample <- st_as_sfc(sampleOut)

plot(poly)
plot(triangles, add = TRUE)
plot(sample, add = TRUE, pch = 20)





## Grid 

gridOut <- "MULTIPOINT((513824.35002515046 7017062.209554264), (513824.35002515046 7017077.209554264), (513824.35002515046 7017092.209554264), (513824.35002515046 7017107.209554264), (513824.35002515046 7017122.209554264), (513829.35002515046 7017062.209554264), (513829.35002515046 7017077.209554264), (513829.35002515046 7017092.209554264), (513829.35002515046 7017107.209554264), (513829.35002515046 7017122.209554264), (513834.35002515046 7017062.209554264), (513834.35002515046 7017077.209554264), (513834.35002515046 7017092.209554264), (513834.35002515046 7017107.209554264), (513834.35002515046 7017122.209554264), (513839.35002515046 7017062.209554264), (513839.35002515046 7017077.209554264), (513839.35002515046 7017092.209554264), (513839.35002515046 7017107.209554264), (513839.35002515046 7017122.209554264), (513844.35002515046 7017062.209554264), (513844.35002515046 7017077.209554264), (513844.35002515046 7017092.209554264), (513844.35002515046 7017107.209554264), (513844.35002515046 7017122.209554264))"
grid <- st_as_sfc(gridOut)

plot(poly)
plot(grid, add = TRUE)



## KDTree

queryOut <- "POINT(513834.35002515046 7017092.209554264)"
query <- st_as_sfc(queryOut)

plot(query, add = TRUE, pch = 20, col = "blue")


neighboursOut <- "MULTIPOINT((513829.35002515046 7017092.209554264), (513839.35002515046 7017092.209554264), (513824.35002515046 7017092.209554264), (513844.35002515046 7017092.209554264), (513834.35002515046 7017107.209554264), (513834.35002515046 7017077.209554264))"
neighbours <- st_as_sfc(neighboursOut)

plot(neighbours, add = TRUE, pch = 20, col = "red")




## SpatiallyBalanced

sampleOut <- "MULTIPOINT((513823.3949928667 7017113.473576938), (513835.3390959412 7017102.25052201), (513841.6130045155 7017074.082875976), (513842.75252264715 7017083.186716987), (513842.8133646947 7017090.804823144))"
sample <- st_as_sfc(sampleOut)

plot(poly)
plot(sample, add = TRUE, pch = 20)





## Workflow: Survival

workflowcmd <- "dotnet run Workflow Survival --project .\\Workflows\\Workflows.csproj"

sampleList <- vector("list", repeats)

for(i in seq(1, repeats, 1)){
  
  sampleList[[i]] <- system(workflowcmd, intern = TRUE)
  
}

plot(poly)

lapply(sampleList, st_as_sfc) %>% 
  lapply(plot, add = TRUE, pch = 20)


















